# CodexSentinel Configuration

version: 1

# Project root directory (optional, default is current working directory)
root: "."

# Target directory to scan
target: "./"

# Excluded paths or glob patterns
exclude:
  - "vendor/**"
  - "**/testdata/**"
  - "**/*.pb.go"
  - "**/mocks/**"

# Enabled built-in analyzers
analyzers:
  deadcode: true
  globals: true
  size: true
  duplication: true
  complexity: true
  entropy: true
  license: true
  osv: true
  imports: true
  directcalls: true
  godstruct: true
  layers: true
  taint: true
  command_exec: true

# Thresholds for warnings
thresholds:
  complexity: 15
  duplication: 5 # Min duplicated lines
  file_size_kb: 200
  global_vars: 0
  entropy_threshold: 4.5 # For secrets

# Rule files (custom static analysis rules in YAML format)
rule_files:
  - "rules/security.yml"
  - "rules/conventions.yml"

# Output formats
report:
  output: "./reports"
  formats:
    - html
    - json
    - markdown
    - sarif

# Severity overrides (optional)
severity:
  deadcode: "low"
  globals: "medium"
  command_exec: "high"

# Parallelism settings
concurrency:
  max_workers: 4

# Cache directory (optional)
cache_dir: ".codex_cache"

# Fail on issues of given severity or higher
fail_on: "high"

# Verbosity level: silent | error | warn | info | debug
log_level: "info"

# False positive management configuration
false_positive_management:
  enable_auto_suppression: true
  enable_confidence_scoring: true
  enable_context_aware_analysis: true
  enable_safe_pattern_detection: true
  enable_validation_tracking: true
  confidence_threshold: 0.6
  max_suppression_rate: 0.15

# Rule-specific false positive settings
rules:
  false_positive_config:
    enable_context_analysis: true
    enable_validation_checks: true
    enable_safe_patterns: true
    min_confidence: 0.5
    max_false_positive_rate: 0.08

# Advanced false positive settings
advanced_false_positive:
  # Suppress findings in test files
  suppress_test_files: true

  # Suppress findings with validation
  suppress_with_validation: true

  # Suppress findings with sanitization
  suppress_with_sanitization: true

  # Suppress low confidence findings
  suppress_low_confidence: true

  # Suppress common false positive patterns
  suppress_common_patterns: true

  # Custom safe patterns
  safe_patterns:
    - "html.EscapeString"
    - "template.HTMLEscapeString"
    - "filepath.Clean"
    - "filepath.Join"
    - "os.Stat"
    - "json.Marshal"
    - "xml.Marshal"
    - "text/template"
    - "html/template"

  # Custom validation patterns
  validation_patterns:
    - "validate"
    - "check"
    - "verify"
    - "test"
    - "assert"
    - "sanitize"
    - "escape"
    - "clean"
    - "filter"

  # Custom sanitization patterns
  sanitization_patterns:
    - "escape"
    - "sanitize"
    - "clean"
    - "filter"
    - "strip"
    - "html.escape"
    - "template.escape"
    - "url.escape"
